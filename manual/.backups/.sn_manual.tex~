\documentclass[a4paper,12pt,leqno,notitlepage]{article}
\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext,textcomp}
\usepackage[unicode,bookmarksopen=true,pdfborder=0,pdfstartview=FitH]{hyperref}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{longtable}
%\usepackage{grffile}
\usepackage{epsfig}
%\usepackage[pdftex]{graphicx}
\usepackage{epstopdf}
\usepackage{verbatim}    %comments like \begin{comment}..... \end{comment}
\frenchspacing
\righthyphenmin=2
\sloppy


\usepackage[left=20mm,right=15mm,top=20mm,bottom=20mm,bindingoffset=0cm]{geometry}
\usepackage{setspace}
%\textwidth=15.3cm
%\textheight=25cm
%\oddsidemargin=1cm
%\evensidemargin=1cm
%\renewcommand{\captionlabeldelim}{.} %точка вместо двоеточия в номере таблиц и рисунков
%\headheight=0.1cm
%\topmargin=0.1cm
%\headsep=0.1cm
\begin{document}

\begin{center}
  {\Huge Инструкция к программе signalNoise

  [DRAFT]}
\end{center}

\section{Введение}

Программа signalNoise\textsuperscript{TM} предназначена для проведения оценочной фотометрии 
``на лету'', непосредственно в процессе наблюдения. Программа позволяет оценить видимую звездную
величину объекта, а также отношение сигнал/шум для объекта и звезд сравнения.

\section{Запуск}
Программу надо запускать в процессе наблюдений, когда уже записан хотя бы один кадр наблюдаемого объекта
(плюс, естественно, биасы и дарки). Ярлык для запуска программы расположен на рабочем столе, слева,
примерно посередине (если он никуда не переехал).

Вместе с окном программы откроется черное окно терминала, это происходит из-за непонятной пока ошибки в
windows, возможно, со временем удастся от этого избавиться. Пока что можно просто свернуть (но не закрывать)
это окошко и не обращать на него внимание.

После запуска программы в меню ``File'' надо выбрать пункт ``Select folder''. По умолчанию программа сама
находит самую новую папку в telescopeData и выбирает ее, нужно только проверить, что все правильно,
и нажать окей. Если Вы пишете в какую-то нестандартную папку, то придется ее выбирать вручную.

\section{Работа программы}
Работа программы происходит полностью в автоматическом режиме, после того, как выбрана рабочая директория, больше
ничего нажимать не надо (ура!).

После запуска программа работает по следующему кругу:
\begin{enumerate}
\item Программа определяет какой объект, в каком фильтре в данный момент наблюдается, производит сложение всех
  изображений соответствующей серии и показывает в окошке получившееся изображение.
\item Производится попытка отождествить объект и стандарты, опираясь на специально подготовленные маски.
  Если эта попытка успешная, то поверх кадра появятся кружочки: зеленые вокруг стандартов и красный
  вокруг объекта. Если какие-то из кружков серого цвета, то значит, что отождествление прошло
  успешно, но объект слишком слабый (меньше $3\sigma$ от фона) и его фотометрические параметры
  получить не удается. В таком случае надо подождать пока телескоп запишет еще кадров.
\item После успешного отождествления объектов в правой части окна появятся фотометрические параметры:
  \begin{itemize}
  \item Звездная величина объекта в соответствующем фильтре
  \item Соотношение сигнал/шум для объекта и всех стандартов.
  \end{itemize}
  Если наблюдения производятся в поляриметрии, то звездная величина показываться не будет,
  будут показаны только отношения сигнал/шум для объекта и стандартов (отдельно для обыкновенного
  и необыкновенного лучей). В этом случае количество кружков должно удвоиться.
\item Если при добавлении очередного кадра отношение сигнал/шум \textit{уменьшилось}, то
  под областью фотометрических параметров программа красным цветом напишет имя кадра, при добавлении
  которого это произошло. Такое может произойти, например, при пролете облака. В этом случае наблюдатель
  может удалить файл с указанным кадром, после чего программа перестанет его рассматривать.

  \textbf{Внимание:} к данной опции нужно относиться осторожно. Если отношение сигнал/шум объекта
  невелико, то из-за особенностей определения уровня шума в пакете SExtractor возможны ложные срабатывания
  данной функции. Перед удалением рекомендуется взглянуть на подозрительный файл, действительно ли там облако
  или что-нибудь еще.
\item Программа немножко отдыхает и идет к первому пункту.
\end{enumerate}


\section{Результат}
Значения звездных величин, определяемых программой, довольно близки к величинам, получаемым пакетом  PHOT
(как правило разница с запасом ложится в $\pm 0.03^m\dots 0.05^m$), поэтому получаемые величины
могут быть использованы для оценки состояния объекта и необходимости его более тщательного наблюдения
в текущую ночь.

Значения отношений сигнал/шум планируется использовать для оценки того, достаточна ли уже суммарная экспозиция
для проведения надежной фотометрии. Цель: оптимизация временных затрат путем сокращения экспозиции при
хорошем отношении S/N. Величина достаточного отношения S/N, правда, пока не определена и требует
проведения экспериментов.

\section{На что обратить внимание}
\begin{enumerate}
\item Программа новая, возможны ошибки и падения.
\item Программа должна показывать название текущего объекта, правильный фильтр, правильное количество
снятых кадров. Если что-то не соответствует действительности, то возможно произошла ошибка и надо перезапустить
программу. Проверить наверняка, работает ли программа очень просто: если по мере получения новых кадров счетчик
суммированных кадров в программе не обновляется, то программа не работает.
\item В большинстве случаев полный перезапуск программы не требуется, достаточно заново выбрать рабочую папку.
\end{enumerate}

\subsection{Поле не отождествляется}
Возможные причины того, что поле не отождествилось:
\begin{enumerate}
\item Вы наблюдаете mkn421: это очень бедное на звезды поле и отождествить автоматически его, увы, не удается
\item Низкий сигнал/шум (облачность, большой фон, слабые звезды поля). Подождите пока запишется побольше кадров,
 может быть поле отождествится, когда проступят более слабые звезды.
\item Поле может не отождествиться если телескоп наведен далеко от рекомендованного поисковыми картами положения
  (так что перекрытие наблюдаемых кадров с маской мало).
\item Если ничего из вышеперечисленного не соответствует действительности, а поле все равно не отождествляется,
возможно допущена ошибка в составлении маски. Сообщите об этом.
\end{enumerate}

\section{Дополнительные возможности}

\subsection{Rename files}
Если при записи серии часть кадров была удалена (например из-за облаков, ветра или посторонних
объектов в кадре), и наблюдатель хочет дописать несколько кадров к серии, то нужно переименовать
первые кадры серии, чтобы CCDOps не переписывала их. Данная функция позволяет упростить этот
процесс. Нужно нажать кнопку File $\Rightarrow$ Rename Files и в появившемся окошке указать
желаемое число экспозиций в текущей серии (то есть если наблюдатель планировал записать
10 кадров, то нужно указать число 10) и нажать кнопку OK. Программа автоматически переименует
файлы так чтобы сместить их номера к конечному. Например, если наблюдатель планировал записать
10 кадров, но из-за ветра серия выглядит так: *001, *002, *004, *005, *008, *009, то результатом
работы функции будет список файлов *005, *006, *007, *008, *009, *010.

После переименования, если все в порядке, появится окошко с надписью All done: minor exposure is 5,
что означает, что наблюдатель может сразу поставить в CCDOps на запись файлы с первого по четвертый
и никакие файлы не перетрутся.

\subsection{Reset}
Если кажется, что программа работает не совсем правильно, можно попробовать нажать кнопку
File $\Rightarrow$ Reset, что в большинстве случаев равнозначно перезапуску программы. 

\subsection{Лог}
Если наблюдатель хочет просмотреть значения звездных величин объектов, наблюдавшихся
в течение ночи, то он может нажать кнопку Log, в результате чего появится окошко со
звездными величинами всех объектов во всех фильтрах, наблюдавшихся в течение ночи.

\subsection{Будильник}
Если наблюдатель хочет отвлечься от созерцания CCDOps, но не хочет проспать окончание серии, то
он может нажать на кнопку Alarm и ввести число экспозиций, выставленное для записи в CCDops.
Когда до конца серии останется один кадр программа издаст звуковой сигнал, после записи последнего
кадра прозвучит двойной сигнал. (Disclaimer: автор программы не призывает злоупотреблять этой опцией,
все пропущенные облака и самолеты в кадре остаются на совести наблюдателя). 

\subsection{Проверка фильтра}
Программа следит за тем, чтобы фильтр, указанный в названии файла, и фильтр в созданном CCDops хидере
совпадали. Если фильтры не совпадают (например, наблюдатель забыл его переключить), то программа
издаст серию коротких гудков, в правой части окошка программы будет соответствующее сообщение об ошибке.

\subsection{PolarCheck}
Опция PolarCheck позволяет в процессе записи фотометрической серии ``предсказать'', как будет выглядеть
кадр в поляризации. Если наблюдатель не уверен, что в поляризации что-нибудь не наложится, то он может
нажать на кнопку PolarCheck. В появившемся окне будут показаны симулированные изображения в ``Y'' и ``X'',
как бы они выглядели, если начать записывать поляриметрию с текущим положением камеры. Если объект
или стандарты накладываются, то наблюдатель может нажимать на кнопки ``+5 deg'' и ``--5 deg'', чтобы
повращать поле и понять в какую сторону и на сколько надо повернуть камеру перед началом записи
в поляриметрической моде.

\section{Feedback}
Пожалуйста, все неполадки с программой отмечайте в журнале наблюдений. Если возникла ошибка, то
укажите на каком объекте и в каком фильтре это произошло.

\end{document}